<!DOCTYPE html>
<html lang="pl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <title>Kalkulator walut</title>
    <script src="skrypt.js" defer></script>
    <script src="slimselect.js"></script>
    <link href="slimselect.css" rel="stylesheet"></link>
    <link rel="stylesheet" href="style.css">
    
</head>
<body>
<section class="hero-unit">
  <h1 class="hero-unit__header">Kalkulator walut</h1>
  <p class="hero-unit__subheader">Kalkulator walutowy służy do przeliczania aktualnych kursów walut. Obliczany jest na podstawie kursów średnich udostępnianych przez NBP.</p>
  <form class="hero-unit__form">
    <p data-label="Mam">
      <input type="number" id="input1" autocomplete="off" step="none">
      <select name ="waluta1" id="curr1" class="ajax">
        <option value="PLN">PLN</option>
        <!-- options generated by slim-select -->
      </select>
    </p>
    <div class="hero-unit__button">
      <img src="arr.png" alt="arrow" width="40" height="40">
    </div>
    <p data-label="Otrzymam">
      <input type="text" id="input2" disabled>
      <select name="waluta2" id="curr2" class="ajax1">
        <!-- options generated by slim-select -->
      </select>
    </p>
  </form>
</section>

<section class="tables">
  <h2 class="tables__header">Tabele kursów</h2>
  <p class="tables__subheader">Bieżące kursy średnie walut obcych w złotych</p>
  
  <table class="tables__table" id="tableA">
  <p class="tables__title"></p>
  <table class="tables__table" id="tableB">
  </table>
</section>
<script>

let select = new SlimSelect({
  select: '.ajax',
  valuesUseText: false
});
let select1 = new SlimSelect({
  select: '.ajax1',
  valuesUseText: false
});

let data =[];
data.push({innerHTML: '<img width="30" height="30" src="flags/pln.svg"></img> <div><div>PLN</div><br><div class="currency">Złoty polski</div></div>', text: 'PLN', value: 'PLN', currency: 'Złoty polski'});
fetch('https://api.nbp.pl/api/exchangerates/tables/a/')
  .then(res => res.json())
  .then(json => {
    let rates = json[0].rates;
    rates.forEach(el => {
      console.log(el.code);
      if (el.code == 'ZAR') {el.currency = 'rand południowoafrykański'};
      data.push({innerHTML: '<img width="30" height="30" src="flags/'+el.code+'.svg"></img> <div><div>'+ el.code +'</div><br><div class="currency">'+ el.currency+ '</div></div>', text: el.code, value: el.code, currency: el.mid});
    });
    
  })
  .then(
    fetch('https://api.nbp.pl/api/exchangerates/tables/b/')
    .then(res => res.json())
    .then(json => {
      let rates = json[0].rates;
      rates.forEach(el => {
        data.push({innerHTML: '<img width="30" height="30" src="flags/'+el.code+'.svg"></img> <div><div>'+ el.code +'</div><br><div class="currency">'+ el.currency+ '</div></div>', text: el.code, value: el.code, currency: el.mid});
      });
      select.setData(data);
      select1.setData(data);
      select.set('PLN');
      select1.set('EUR');
    })
  )

</script>
</body>
</html>